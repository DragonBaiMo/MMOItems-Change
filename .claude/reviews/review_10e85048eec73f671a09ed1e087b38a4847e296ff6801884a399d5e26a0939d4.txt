# 变更摘要：修复玩家离线时的物品降级崩溃问题，并尝试扩展宝石的死亡降级属性。

## 文件：MMOItems-API/src/main/java/net/Indyuce/mmoitems/ItemStats.java
### L241：[MEDIUM] 属性依赖定义不一致
`DOWNGRADE_ON_DEATH_CHANCE` 已扩展支持 `gem_stone`，但其前置开关属性 `DOWNGRADE_ON_DEATH` (L240) 仍仅限 `equipment`。
如果业务逻辑要求先检查“是否开启死亡降级”（BooleanStat），再读取“降级概率”，则宝石上的概率属性将因缺少前置开关而无法生效（死代码）。

建议将 `DOWNGRADE_ON_DEATH` 也扩展至支持 `gem_stone`：

```diff
-            DOWNGRADE_ON_DEATH = new BooleanStat("DEATH_DOWNGRADE", Material.DAMAGED_ANVIL, "Downgrade on Death", new String[]{"If the wearer of this item dies, it may", "downgrade (based on &6Death Downgrade", "&6Chance &7stat)", "", "Required to define an &6Upgrade Template", "Requires keep-inventory gamerule. "}, new String[]{"equipment"}),
+            DOWNGRADE_ON_DEATH = new BooleanStat("DEATH_DOWNGRADE", Material.DAMAGED_ANVIL, "Downgrade on Death", new String[]{"If the wearer of this item dies, it may", "downgrade (based on &6Death Downgrade", "&6Chance &7stat)", "", "Required to define an &6Upgrade Template", "Requires keep-inventory gamerule. "}, new String[]{"equipment", "gem_stone"}),
```

## 文件：MMOItems-Dist/src/main/java/net/Indyuce/mmoitems/listener/PlayerListener.java
### 审查通过
新增的 `!playerData.isOnline()` 检查正确地防御了玩家在死亡后立即离线可能导致的潜在异常。